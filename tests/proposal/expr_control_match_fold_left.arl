archetype effect_control_match_fold_left

variable res : list<nat> = []

entry exec () {
  var l = [1; 2; 3];
  var empty : list<nat> = [];
  var p : or<list<nat> * list<nat>, list<nat>> = left<list<nat>> ((empty, l));
  res :=
    match_fold_left p with
    | x -> match_list x[1] with
           | hd::tail -> p := left<list<nat>> ((prepend(hd, x[0]), tail))
           | [] -> p := right<list<nat> * list<nat>>(x[0])
           end
    end
}
